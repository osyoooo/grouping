# 研修グループ分けアプリ 研修楽々くん

企業研修や合同研修において、公平で効率的なグループ分けを自動化するStreamlitアプリケーションです。

## 🎯 概要

複数の会社から参加者が集まる研修において、以下の条件を満たすグループ分けを自動生成します：

- **企業重複の回避**: 同じ会社の人を可能な限り別グループに配置
- **個人重複の最小化**: 過去に同じグループになった人同士を避ける
- **公平な人数配分**: 各グループの人数をできるだけ均等に調整

## 🚀 機能

### 基本機能
- 会社数と各社の参加人数の設定
- 研修日数と1日あたりのグループ数の設定
- 自動グループ分けアルゴリズム（100回試行による最適化）
- 日別グループ構成の表示
- 企業重複の警告表示

### 分析機能
- 参加者間の同席回数マトリクス（色付き表示）
- 企業重複状況の可視化
- 条件に応じた警告メッセージ

### 出力機能
- 日別グループ一覧表
- 参加者リスト（受講者番号と会社）
- 重複回数マトリクス

## 📋 使い方

### 1. 基本設定

サイドバーで以下の項目を設定します：

#### 会社情報
- **会社の数**: 参加する会社数を入力（1社以上）
- **会社ごとの参加人数**: 各会社（A, B, C...）の参加者数を設定

#### 研修設定
- **研修の日数**: 何日間の研修かを設定
- **1日あたりのグループ数**: 1日に作るグループの数を設定

### 2. 設定例

```
会社の数: 12
会社Aの参加者: 2名
会社Bの参加者: 2名
会社Cの参加者: 3名
...（以下同様）
研修の日数: 3日
1日あたりのグループ数: 5グループ
```

### 3. グループ分け実行

「グループ分けを作成する」ボタンをクリックすると、自動的にグループ分けが実行されます。

### 4. 結果の確認

#### ✅ グループ分けの結果
各日のグループ構成が表形式で表示されます：
- グループ名（グループ1, グループ2...）
- メンバー一覧（受講者番号(会社)の形式）
- 企業重複情報（同じ会社のメンバーが複数いる場合の警告）

#### 🤝 参加者の重複回数（マトリクス）
- 縦軸・横軸に受講者番号
- 交差点の数字が同じグループになった回数
- **2回以上同席した場合は淡い赤色で表示**

#### 👥 参加者リスト
- 受講者ナンバー（1から通し番号）
- 所属会社（A, B, C...）

## ⚠️ 注意事項

### 警告が表示される場合

#### 企業重複警告
```
注意: 最も人数の多い会社（5名）がグループ数（3）を上回っているため、
グループ内で企業重複が必ず発生します。
```
**対策**: グループ数を増やすか、大きな会社の参加者数を調整

#### 人数不均等警告
```
合計参加人数がグループ数で割り切れないため、
グループごとの人数が均等になりません。
```
**対策**: 参加者数またはグループ数を調整（必須ではありません）

### エラーが発生する場合

```
◯日目のグループ分けに失敗しました。条件が複雑すぎる可能性があります。
```
**対策**: 
- グループ数を調整
- 参加者数の分布を見直し
- 研修日数を減らす

## 🛠️ 技術仕様

### 必要なライブラリ
```python
streamlit
pandas
numpy
random
itertools
collections
```

### アルゴリズム
- **最適化手法**: ランダムサンプリング + スコア評価（100回試行）
- **スコア計算**: 企業重複ペナルティ（重み100）+ 個人重複回数
- **グループ分け**: 貪欲法による最適配置

### 実行環境
- Python 3.7以上
- Streamlit対応ブラウザ

## 🎨 カスタマイズ

### デフォルト設定の変更

```python
# デフォルト会社数
num_companies = st.number_input('会社の数', min_value=1, value=12, step=1)

# デフォルト参加者数パターン
default_value = {0:2, 1:2, 2:3, 3:2, 4:1, 5:3, 6:2, 7:2, 8:2, 9:2, 10:2, 11:2}.get(i, 1)

# デフォルト研修設定
num_days = st.number_input('研修の日数', min_value=1, value=3, step=1)
num_groups = st.number_input('1日あたりのグループ数', min_value=1, value=5, step=1)
```

### 色設定の変更

```python
def highlight_cells(val):
    if val >= 2:
        return 'background-color: #FFE6E6'  # この色を変更
    return ''
```

## 📊 活用例

### 適用場面
- 企業合同研修のグループワーク
- 異業種交流会の席割り
- チームビルディング活動
- ネットワーキング促進イベント

### 効果
- 公平なグループ分け
- 企業間交流の促進
- 手作業での調整作業の削減
- 透明性のある配置プロセス

## 🔧 トラブルシューティング

### よくある問題と解決法

| 問題 | 原因 | 解決法 |
|------|------|--------|
| グループ分けが生成されない | 条件が厳しすぎる | グループ数を調整 |
| 企業重複が多い | 会社の人数がグループ数より多い | グループ数を増やす |
| アプリが重い | 参加者数が多すぎる | 試行回数を調整 |
| マトリクスが見づらい | 参加者数が多い | 画面を拡大表示 |

## 📝 ライセンス

このアプリケーションはオープンソースとして提供されています。
研修や教育目的での利用を推奨します。

---

**開発者向け情報**: 
このアプリはStreamlitフレームワークを使用しており、Webブラウザ上で動作します。
カスタマイズや機能追加が容易な設計となっています。
